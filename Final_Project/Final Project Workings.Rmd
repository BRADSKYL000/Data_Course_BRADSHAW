---
title: "Fuel Alternatives in Utah"
author: "Kyle Bradshaw"
date: '2022-05-01'
output:
  html_document:
    code_folding: hide
    toc: yes
    toc_depth: 4
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '4'
---

```{r setup chunk, setup, include = FALSE, cache=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(usmap)
library(ggmap)
library(rstudioapi)
library(tidyverse)
library(geosphere)
```

## Alternative Fuel Types

In recent, ethanol powered cars are becoming less beneficial politically, environmentally, and economically. Starting research and development on several different types of fuel alternatives. We are all familiar with gasoline and electric cars but there are a few others. A datasheet taken from "https://afdc.energy.gov/" shows all public and private fueling stations for several different fuel types across the whole country. Below I have taken the information and formatted it for use here in the Wasatch front. Is electric the only alternative to regular unleaded.

```{r, include = FALSE}
stations <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-03-01/stations.csv')

station <- stations[which(stations$ACCESS_CODE == 'public'),]

Ustation <- station[which(station$STATE == 'UT'),]
```

```{r}
# This is using the data taken on electric stations in Utah, removing duplicates
UCNGS <- Ustation[which(Ustation$FUEL_TYPE_CODE == 'CNG'),]

UCDF <- data.frame(UCNGS$LATITUDE,UCNGS$LONGITUDE,site=factor(1:28))

DC <-  distm(UCDF[,c(2,1)]) %>%  as.data.frame()

DC[DC==0] <- NA

MCDis <- apply(DC,1,min,na.rm=TRUE)

minC <- c()
x = 1
for(i in 1:length(MCDis)){
  minC[x] <- which(DC[,i] == MCDis[i])  
  x=x+1
}

UCDF$closest <- minC

nearest_distC <- c()
for(i in 1:length(UCDF$closest)){
  nearest_distC[i] <- distHaversine(UCDF[i,c(2,1)],UCDF[UCDF$closest[i],c(2,1)])  
}

UCDF$nearest_dist_m <- nearest_distC

UCDF
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
